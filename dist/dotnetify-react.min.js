var dotnetify="undefined"==typeof dotnetify?{}:dotnetify;!function(a){var b=window||global;if("object"==typeof exports&&"object"==typeof module){var c="undefined"!=typeof window?window.jQuery||require("./jquery-shim"):require("./jquery-shim");module.exports=a(c,b,require("./no-jquery.signalR"))}else"function"==typeof define&&define.amd?define(["./jquery-shim","./no-jquery.signalR"],a):a(jQuery,b)}(function(a,b){function c(b,c,d){this.$vmId=b,this.$component=c,this.$vmArg=d&&d.vmArg,this.$headers=d&&d.headers,this.$exceptionHandler=d&&d.exceptionHandler,this.$requested=!1,this.$loaded=!1,this.$itemKey={};var e=d&&d.getState,f=d&&d.setState;e="function"==typeof e?e:function(){return c.state},f="function"==typeof f?f:function(a){c.setState(a)},c&&c.props&&c.props.hasOwnProperty("vmArg")&&(this.$vmArg=a.extend(this.$vmArg,c.props.vmArg)),this.State=function(a){return"undefined"==typeof a?e():f(a)};for(var g in dotnetify.react.plugins){var h=dotnetify.react.plugins[g];h.hasOwnProperty("$inject")&&h.$inject(this)}}return function(a,b,c){"use strict";function d(b,c){return function(){c.apply(b,a.makeArray(arguments))}}function e(b,c){var e,f,g,h,i;for(e in b)if(b.hasOwnProperty(e)){if(f=b[e],!f.hubName)continue;i=c?f.on:f.off;for(g in f.client)if(f.client.hasOwnProperty(g)){if(h=f.client[g],!a.isFunction(h))continue;i.call(f,g,d(f,h))}}}if("function"!=typeof a.signalR)throw new Error("SignalR: SignalR is not loaded. Please ensure jquery.signalR-x.js is referenced before ~/signalr/js.");var f=a.signalR;a.hubConnection.prototype.createHubProxies=function(){var b={};return this.starting(function(){e(b,!0),this._registerSubscribedHubs()}).disconnected(function(){e(b,!1)}),b.dotNetifyHub=this.createHubProxy("dotNetifyHub"),b.dotNetifyHub.client={},b.dotNetifyHub.server={dispose_VM:function(c){return b.dotNetifyHub.invoke.apply(b.dotNetifyHub,a.merge(["Dispose_VM"],a.makeArray(arguments)))},request_VM:function(c,d){return b.dotNetifyHub.invoke.apply(b.dotNetifyHub,a.merge(["Request_VM"],a.makeArray(arguments)))},update_VM:function(c,d){return b.dotNetifyHub.invoke.apply(b.dotNetifyHub,a.merge(["Update_VM"],a.makeArray(arguments)))}},b},f.hub=a.hubConnection(dotnetify.hubPath,{useDefaultPath:!1}),a.extend(f,f.hub.createHubProxies())}(a,b),dotnetify=a.extend(dotnetify,{hub:null,hubServerUrl:null,hubServer:a.connection.dotNetifyHub.server,hubOptions:{transport:["webSockets","longPolling"]},hubPath:"/signalr",debug:!0,debugFn:null,offline:!1,isOffline:!0,offlineTimeout:5e3,offlineCacheFn:null,_connectRetry:0,isConnected:function(){return a.connection.hub.state==a.signalR.connectionState.connected},connect:function(a,b){return dotnetify.react.connect(a,null,b)}}),dotnetify.react=a.extend(dotnetify.hasOwnProperty("react")?dotnetify.react:{},{version:"1.0.4-beta",viewModels:{},plugins:{},init:function(){var b=dotnetify.react,c=function(){for(var a in b.viewModels)b.viewModels[a].$requested||b.viewModels[a].$request()};if(null===dotnetify.hub){dotnetify.hubServerUrl&&(a.connection.hub.url=dotnetify.hubServerUrl);var d=a.connection.dotNetifyHub;d.client.response_VM=function(a,c){var e=b.viewModels.hasOwnProperty(a)?b.viewModels[a]:null,f=JSON.parse(c);if(f&&f.hasOwnProperty("ExceptionType")&&f.hasOwnProperty("Message")){var g={name:f.ExceptionType,message:f.Message};if(e&&"function"==typeof e.$exceptionHandler)return e.$exceptionHandler(g);throw console.error("["+a+"] "+g.name+": "+g.message),g}e?e.$update(c):d.server.dispose_VM(a)};var e=function(){var b="undefined"==typeof dotnetify.hubOptions?a.connection.hub.start():a.connection.hub.start(dotnetify.hubOptions);return b.done(function(){dotnetify._connectRetry=0,c()}).fail(function(a){console.error(a)}),setTimeout(function(){dotnetify.offline&&!dotnetify.isConnected()&&(c(),dotnetify.isOffline=!0,a(document).triggerHandler("offline",dotnetify.isOffline))},dotnetify.offlineTimeout),b};dotnetify.hub=e(),a.connection.hub.disconnected(function(){setTimeout(function(){dotnetify.hub=e()},5e3*dotnetify._connectRetry+500),dotnetify._connectRetry<3&&dotnetify._connectRetry++}),a.connection.hub.stateChanged(function(b){var c={0:"connecting",1:"connected",2:"reconnecting",4:"disconnected"};console.log("SignalR: "+c[b.newState]);var d=1!=b.newState;dotnetify.isOffline!=d&&(dotnetify.isOffline=d,a(document).triggerHandler("offline",dotnetify.isOffline))})}else dotnetify.isConnected()?dotnetify.hub.done(c):dotnetify.offline&&c()},connect:function(a,b,d){if(arguments.length<2)throw new Error("[dotNetify] Missing arguments. Usage: connect(vmId, component) ");if(arguments.length>3)throw new Error("[dotNetify] Deprecated parameters. New usage: connect(vmId, component [,{getState, setState, vmArg, headers, exceptionHandler}]) ");if(dotnetify.ssr){var e=d&&d.vmArg;return dotnetify.react.ssrConnect(a,b,e)}var f=dotnetify.react;return f.viewModels.hasOwnProperty(a)?console.error("Component is attempting to connect to an already active '"+a+"'.  If it's from a dismounted component, you must add vm.$destroy to componentWillUnmount()."):f.viewModels[a]=new c(a,b,d),f.init(),f.viewModels[a]},ssrConnect:function(d,e,f){null!=b.ssr&&b.ssr.hasOwnProperty(d)||console.error("Server-side rendering requires initial state in 'window.ssr."+d+"'.");var g=dotnetify.react,h=b.ssr[d],i=function(){return h},j=function(b){h=a.extend(h,b)},k=g.viewModels[d]=new c(d,e,i,j,f);return setTimeout(function(){k.$update(JSON.stringify(b.ssr[d]))},100),k}}),c.prototype.$destroy=function(){for(var a in dotnetify.react.plugins){var b=dotnetify.react.plugins[a];"function"==typeof b.$destroy&&b.$destroy.apply(this)}dotnetify.hubServer.dispose_VM(this.$vmId),delete dotnetify.react.viewModels[this.$vmId]},c.prototype.$dispatch=function(a){if(dotnetify.isConnected())try{dotnetify.hubServer.update_VM(this.$vmId,a),dotnetify.debug&&(console.log("["+this.$vmId+"] sent> "),console.log(a),null!=dotnetify.debugFn&&dotnetify.debugFn(this.$vmId,"sent",a))}catch(a){console.error(a)}},c.prototype.$dispatchListState=function(a){for(var b in a){var c=this.$itemKey[b];if(!c)return void console.error("["+this.$vmId+"] missing item key for '"+b+"'; add "+b+"_itemKey property to the view model.");var d=a[b];if(!d[c])return console.error("["+this.$vmId+"] couldn't dispatch data from '"+b+"' due to missing property '"+c+"'"),void console.error(d);for(var e in d)if(e!=c){var f={};f[b+".$"+d[c]+"."+e]=d[e],this.$dispatch(f)}this.$updateList(b,d)}},c.prototype.$preProcess=function(a){var b=this;for(var c in a){var d=/(.*)_add/.exec(c);if(null==d){var d=/(.*)_update/.exec(c);if(null==d){var d=/(.*)_remove/.exec(c);if(null==d){var d=/(.*)_itemKey/.exec(c);if(null==d);else{var e=d[1],f={};f[e]=a[c],b.$setItemKey(f),delete a[c]}}else{var e=d[1];if(Array.isArray(this.State()[e])){var g=this.$itemKey[e];null!=g?b.$removeList(e,function(b){return b[g]==a[c]}):console.error("["+this.$vmId+"] missing item key for '"+e+"'; add "+e+"_itemKey property to the view model.")}else console.error("["+this.$vmId+"] '"+e+"' is not found or not an array.");delete a[c]}}else{var e=d[1];Array.isArray(this.State()[e])?b.$updateList(e,a[c]):console.error("["+this.$vmId+"] '"+e+"' is not found or not an array."),delete a[c]}}else{var e=d[1];Array.isArray(this.State()[e])?b.$addList(e,a[c]):console.error("unable to resolve "+c),delete a[c]}}},c.prototype.$request=function(){dotnetify.isConnected()&&(dotnetify.hubServer.request_VM(this.$vmId,{$vmArg:this.$vmArg,$headers:this.$headers}),this.$requested=!0)},c.prototype.$update=function(b){dotnetify.debug&&(console.log("["+this.$vmId+"] received> "),console.log(JSON.parse(b)),null!=dotnetify.debugFn&&dotnetify.debugFn(this.$vmId,"received",JSON.parse(b)));var c=JSON.parse(b);this.$preProcess(c);var d=this.State();d=a.extend(d,c),this.State(d),this.$loaded||this.$onLoad()},c.prototype.$onLoad=function(){for(var a in dotnetify.react.plugins){var b=dotnetify.react.plugins[a];"function"==typeof b.$ready&&b.$ready.apply(this)}this.$loaded=!0},c.prototype.$setItemKey=function(a){this.$itemKey=a},c.prototype.$addList=function(a,b){var c=this.$itemKey[a];if(null!=c){if(!b.hasOwnProperty(c))return void console.error("["+this.$vmId+"] couldn't add item to '"+a+"' due to missing property '"+c+"'");var d=this.State()[a].filter(function(a){return a[c]==b[c]});if(d.length>0)return void console.error("["+this.$vmId+"] couldn't add item to '"+listName+"' because the key already exists")}var e=this.State()[a];e.push(b);var f={};f[a]=e,this.State(f)},c.prototype.$removeList=function(a,b){var c={};c[a]=this.State()[a].filter(function(a){return!b(a)}),this.State(c)},c.prototype.$updateList=function(b,c){var d=this.$itemKey[b];if(null!=d){if(!c.hasOwnProperty(d))return void console.error("["+this.$vmId+"] couldn't update item to '"+b+"' due to missing property '"+d+"'");var e={};e[b]=this.State()[b].map(function(b){return b[d]==c[d]?a.extend(b,c):b}),this.State(e)}else console.error("["+this.$vmId+"] missing item key for '"+listName+"'; add "+listName+"_itemKey property to the view model.")},dotnetify}),function(a){if("object"==typeof exports&&"object"==typeof module){var b="undefined"!=typeof jQuery?jQuery:require("./jquery-shim");module.exports=a(require("react"),require("react-dom"),b,require("dotnetify"))}else"function"==typeof define&&define.amd?define(["react","react-dom","./jquery-shim","dotnetify"],a):a(React,ReactDOM,jQuery,dotnetify)}(function(a,b,c,d){var e={version:"0.8.5",map:function(a){return e.routes.defined.hasOwnProperty(a)?e.routes.defined[a]:new e.core.route(a)},root:function(a){e.routes.root=a},rescue:function(a){e.routes.rescue=a},history:{initial:{},pushState:function(a,b,c){e.history.supported?e.dispatch(c)&&history.pushState(a,b,c):e.history.fallback&&(window.location.hash="#"+c)},popState:function(a){var b=!e.history.initial.popped&&location.href==e.history.initial.URL;e.history.initial.popped=!0,b||e.dispatch(document.location.pathname)},listen:function(a){if(e.history.supported=!(!window.history||!window.history.pushState),e.history.fallback=a,e.history.supported)e.history.initial.popped="state"in window.history,e.history.initial.URL=location.href,window.onpopstate=e.history.popState;else if(e.history.fallback){for(route in e.routes.defined)"#"!=route.charAt(0)&&(e.routes.defined["#"+route]=e.routes.defined[route],e.routes.defined["#"+route].path="#"+route);e.listen()}}},match:function(a,b){var c,d,f,g,h,i,j={},k=null;for(k in e.routes.defined)if(null!==k&&void 0!==k)for(k=e.routes.defined[k],c=k.partition(),g=0;g<c.length;g++){if(d=c[g],h=a,d.search(/:/)>0)for(f=0;f<d.split("/").length;f++)f<h.split("/").length&&":"===d.split("/")[f].charAt(0)&&(j[d.split("/")[f].replace(/:/,"")]=h.split("/")[f],i=h.split("/"),i[f]=d.split("/")[f],h=i.join("/"));if(d===h)return b&&(k.params=j),k}return null},dispatch:function(a){var b,c;if(e.routes.current!==a){if(e.routes.previous=e.routes.current,e.routes.current=a,c=e.match(a,!0),e.routes.previous&&(b=e.match(e.routes.previous),null!==b&&null!==b.do_exit&&b.do_exit()),null!==c)return c.run(),!0;null!==e.routes.rescue&&e.routes.rescue()}},listen:function(){var a=function(){e.dispatch(location.hash)};""===location.hash&&null!==e.routes.root&&(location.hash=e.routes.root),"onhashchange"in window&&(!document.documentMode||document.documentMode>=8)?window.onhashchange=a:setInterval(a,50),""!==location.hash&&e.dispatch(location.hash)},core:{route:function(a){this.path=a,this.action=null,this.do_enter=[],this.do_exit=null,this.params={},e.routes.defined[a]=this}},routes:{current:null,root:null,rescue:null,previous:null,defined:{}}};return e.core.route.prototype={to:function(a){return this.action=a,this},enter:function(a){return a instanceof Array?this.do_enter=this.do_enter.concat(a):this.do_enter.push(a),this},exit:function(a){return this.do_exit=a,this},partition:function(){for(var a,b,c=[],d=[],e=/\(([^}]+?)\)/g;a=e.exec(this.path);)c.push(a[1]);for(d.push(this.path.split("(")[0]),b=0;b<c.length;b++)d.push(d[d.length-1]+c[b]);return d},run:function(){var a,b,c=!1;if(e.routes.defined[this.path].hasOwnProperty("do_enter")&&e.routes.defined[this.path].do_enter.length>0)for(a=0;a<e.routes.defined[this.path].do_enter.length;a++)if(b=e.routes.defined[this.path].do_enter[a].apply(this,null),b===!1){c=!0;break}c||e.routes.defined[this.path].action()}},d.react.router={version:"1.0.4-beta",urlPath:document.location.pathname,init:function(){if("undefined"==typeof e)throw new Error("Pathjs library is required for routing.");e.history.listen(!0),e.routes.rescue=function(){}},mapTo:function(a,b){"undefined"!=typeof e&&e.map(a).to(function(){b(this.params)})},match:function(a){if("undefined"!=typeof e){var b=e.match(a,!0);if(null!=b)return b.run(),!0}return!1},overrideUrl:function(a,b){return a},pushState:function(a,b,c){d.react.router.urlPath="","undefined"!=typeof e&&e.history.pushState(a,b,c)},redirect:function(a){d.react.router.urlPath=a;for(var b in d.react.viewModels){var c=d.react.viewModels[b];if(null!=c&&c.$router.routeUrl())return void(d.debug&&console.log("router> redirected"))}window.location.replace(a)},ssrState:function(a){if(window.ssr&&window.ssr[a]&&!window.ssr[a].fetched)return window.ssr[a].fetched=!0,window.ssr[a]},ssr:function(a,b,c,e,f){d.ssr=!0,d.react.router.urlPath=a,d.react.router.overrideUrl=c;var g=document.createElement("script");g.type="text/javascript",g.text="window.ssr="+b+";";var h=document.getElementsByTagName("head")[0];h?h.insertBefore(g,h.firstChild):console.error("router> document head tag is required for server-side render.");var i=!1,j=f?setTimeout(function(){i||e()},f):0;window.addEventListener("dotnetify.routed",function(){i=!0,0!=j&&clearTimeout(j),e()}),window.ssr=JSON.parse(b)},$ready:function(){this.$router.initRouting()}},d.react.router.$inject=function(e){e.$router=function(e){var f=function(){return{trim:function(a){if("string"!=typeof a)return"";for(;a.indexOf("/",a.length-1)>=0;)a=a.substr(0,a.length-1);for(;0==a.indexOf("/");)a=a.substr(1,a.length-1);return a},equal:function(a,b){return null!=a&&null!=b&&a.toLowerCase()==b.toLowerCase()},startsWith:function(a,b){return a.toLowerCase().slice(0,b.length)==b.toLowerCase()},endsWith:function(a,b){return""==b||a.toLowerCase().slice(-b.length)==b.toLowerCase()},dispatchEvent:function(a){if("function"==typeof Event)window.dispatchEvent(new Event(a));else{var b=document.createEvent("CustomEvent");b.initEvent(a,!0,!0),window.dispatchEvent(b)}},grep:function(a,b){return Array.isArray(a)?a.filter(b):[]}}}();return{routes:[],initRoot:function(){var a=this,b=a.State();if(b.hasOwnProperty("RoutingState")&&null!==b.RoutingState&&null!==b.RoutingState.Root&&a.$router._absRoot!=b.RoutingState.Root){var c=a.$component.props.vmRoot,d=f.trim(c);""!=d&&(d="/"+d);var e=f.trim(b.RoutingState.Root);a.$router._absRoot=""!=e?d+"/"+e:d,b.RoutingState.Root=a.$router._absRoot}}.bind(e),initRouting:function(){var a=this,b=a.State();if(null!=b&&b.hasOwnProperty("RoutingState")){if(null===b.RoutingState)return void console.error("router> the RoutingState prop of '"+a.$vmId+"' was not initialized.");var c=b.RoutingState.Templates;if(null!=c&&0!=c.length){d.react.router.$init||(d.react.router.init(),d.react.router.$init=!0),a.$router.initRoot(),c.forEach(function(b,c){var e=null!=b.UrlPattern?b.UrlPattern:b.Id;e=""!=e?e:"/";var f=a.$router.toUrl(e);d.debug&&console.log("router> map "+f+" to template id="+b.Id),d.react.router.mapTo(f,function(c){d.react.router.urlPath="";var f=e;for(var g in c)f=f.replace(":"+g,c[g]);f=f.replace(/\(\/:([^)]+)\)/g,"").replace(/\(|\)/g,""),a.$router.routeTo(f,b)})});var e=a.$router.toUrl(b.RoutingState.Active);""==d.react.router.urlPath&&(d.react.router.urlPath=e),a.$router.routeUrl()||a.$router.raiseRoutedEvent(!0)}}}.bind(e),isActive:function(a){var b=this.State();return!(null==a||!a.hasOwnProperty("Path"))&&f.equal(a.Path,b.RoutingState.Active)}.bind(e),loadView:function(a,b,c,e,g){var h,i=this,j=i.State();if(j.hasOwnProperty("RoutingState")){if(null===j.RoutingState)return void console.error("router> the RoutingState prop of '"+i.$vmId+"' was not initialized.");var k=i.$component.props.vmRoot;k=null!=k?"/"+f.trim(j.RoutingState.Root)+"/"+f.trim(k):j.RoutingState.Root,h={vmRoot:k,vmArg:e}}b=d.react.router.overrideUrl(b,a),c=d.react.router.overrideUrl(c,a),f.endsWith(b,"html")?i.$router.loadHtmlView(a,b,c,e,g):i.$router.loadReactView(a,b,c,e,h,g)}.bind(e),loadHtmlView:function(a,d,e,f,g){var h=this;try{b.unmountComponentAtNode(document.querySelector(a))}catch(a){console.error(a)}c(a).load(d,null,function(){null!=e?c.getScript(e,function(){"function"==typeof g&&g.call(h)}):"function"==typeof g&&g.call(h)})}.bind(e),loadReactView:function(d,e,f,g,h,i){var j=this,k=function(){if(!window.hasOwnProperty(e))return void console.error("["+j.$vmId+"] failed to load view '"+e+"' because it's not a React element.");try{b.unmountComponentAtNode(document.querySelector(d))}catch(a){console.error(a)}try{var c=a.createElement(window[e],h);b.render(c,document.querySelector(d))}catch(a){console.error(a)}"function"==typeof i&&i.call(j,c)};if(null==f)k();else{var l=f.split(",").map(function(a){return c.getScript(a)});c.when.apply(c,l).done(k)}}.bind(e),manualRouteTo:function(a,b,c,d){var e={Id:"manual",Target:b,ViewUrl:c,JSModuleUrl:d};this.$router.routeTo(a,e,!0)}.bind(e),raiseRoutedEvent:function(a){""!=d.react.router.urlPath&&1!=a||(d.debug&&console.log("router> routed"),f.dispatchEvent("dotnetify.routed"))}.bind(e),routeTo:function(a,b,c,e){var g=this,h=g.State();d.debug&&console.log("router> route '"+a+"' to template id="+b.Id);for(var i in d.react.viewModels){var j=d.react.viewModels[i],k=j.$component.props.vmArg;if(null!=k&&"string"==typeof k["RoutingState.Origin"]&&f.equal(k["RoutingState.Origin"],a))return}if(1==c||!g.hasOwnProperty("onRouteEnter")||0!=g.onRouteEnter(a,b)){if(null===b.Target)return void console.error("router> the Target for template '"+b.Id+"' was not set.  Use vm.onRouteEnter() to set the target.");if(null==document.getElementById(b.Target))return d.debug&&console.log("router> target '"+b.Target+"' not found in DOM, use redirect instead"),d.react.router.redirect(g.$router.toUrl(a));var l=b.ViewUrl?b.ViewUrl:b.Id;g.$router.loadView("#"+b.Target,l,b.JSModuleUrl,{"RoutingState.Origin":a},function(){h.RoutingState.Active=a,g.$dispatch({"RoutingState.Active":a}),g.State({"RoutingState.Active":a}),1!=c&&g.hasOwnProperty("onRouteExit")&&g.onRouteExit(a,b),"function"==typeof e&&e.call(g)}.bind(g))}}.bind(e),routeUrl:function(){var a=this,b=a.State();if(!b.hasOwnProperty("RoutingState"))return!1;var c=b.RoutingState.Root;if(null==c)return!1;var e=d.react.router.urlPath;if(d.debug&&console.log("router> routing "+e),f.equal(e,c)||f.equal(e,c+"/")||"/"===e){var g=f.grep(b.RoutingState.Templates,function(a){return""===a.UrlPattern});return g.length>0&&(a.$router.routeTo("",g[0]),d.react.router.urlPath="",a.$router.raiseRoutedEvent(),!0)}if(c+="/",f.startsWith(e,c)){var h=null,g=f.grep(a.$router.routes,function(a){return f.startsWith(e+"/",a.Url+"/")});if(g.length>0)for(var i=0;i<g.length;i++)(null==h||h.Url.length<g[i].Url.length)&&(h=g[i]);if(null!=h){var j=h.Path,k=a.$router.hasOwnProperty("pathToRoute")&&a.$router.pathToRoute.hasOwnProperty(j)?a.$router.pathToRoute[j].$template:null;if(null!=k)return f.equal(d.react.router.urlPath,a.$router.toUrl(j))&&(d.react.router.urlPath=""),f.equal(b.RoutingState.Active,j)?a.$router.raiseRoutedEvent():a.$router.routeTo(j,k,!1,function(){a.$router.raiseRoutedEvent()}),!0}else if(d.react.router.match(e))return d.react.router.urlPath="",a.$router.raiseRoutedEvent(),!0}return!1}.bind(e),toUrl:function(a){var b=this.State(),c=f.trim(a);return"("!=c.charAt(0)&&""!=c&&(c="/"+c),b.hasOwnProperty("RoutingState")?b.RoutingState.Root+c:a}.bind(e)}}(e),e.$route=function(a,b){var c=this,d=c.State();if(null!=a){if(!a.hasOwnProperty("Path")||!a.hasOwnProperty("TemplateId"))throw new Error("Not a valid route");c.$router.initRoot();var e=a.Path,f=null;if(d.hasOwnProperty("RoutingState")&&null!=d.RoutingState.Templates){var g=d.RoutingState.Templates.filter(function(b){return b.Id==a.TemplateId});if(g.length>0)f=g[0],"string"==typeof b&&(f.Target=b),null==e&&(e=null!=f.UrlPattern?f.UrlPattern:f.Id,a.Path=e);else if(null==a.RedirectRoot)throw new Error("vmRoute cannot find route template '"+a.TemplateId)}if(null!=a.RedirectRoot){var h=a.RedirectRoot;"/"==h.charAt(0)&&(h=h.substr(0,h.length-1));var i=a.RedirectRoot.split("/"),j="",k=c.$component.props.vmRoot;if(null!=k)for(var l=k.split("/"),m=0;m<l.length&&(""==l[m]||l[m]!=i[0]);m++)j+=l[m]+"/";return j+=h+"/"+e,c.$router.routes.push({Path:e,Url:j}),j}if(null==f)throw new Error("vmRoute cannot find any route template");a.$template=f,c.$router.pathToRoute=c.$router.pathToRoute||{},c.$router.pathToRoute[e]=a;var n=c.$router.toUrl(e);return c.$router.routes.push({Path:e,Url:n}),n}}.bind(e),e.$handleRoute=function(a){a.preventDefault();var b=a.currentTarget.pathname;if(null==b||""==b)throw new Error("The event passed to $handleRoute has no path name.");d.react.router.pushState({},"",b)}.bind(e)},d.react.router.RouteLink=function(b){return null==b.vm&&console.error("RouteLink requires 'vm' property."),a.createElement("a",{style:b.style,className:b.className,href:null!=b.route?b.vm.$route(b.route):"",onClick:function(a){return a.preventDefault(),null==b.route?void console.error("RouteLink requires 'route' property."):("function"==typeof b.onClick&&b.onClick(),b.vm.$handleRoute(a))}},b.children)},d.react.router.RouteTarget=a.createClass({displayName:"RouteTarget",componentWillMount:function(){var a=document.getElementById(this.props.id);null!=a&&window.ssr&&!window.ssr[this.props.id]?(window.ssr[this.props.id]=!0,this.initialHtml={__html:a.innerHTML}):this.initialHtml={__html:""}},getDOMNode:function(){return this.elem},render:function(){var a=this;return React.createElement("div",c.extend({id:this.props.id,ref:function(b){return a.elem=b}},this.props,{dangerouslySetInnerHTML:this.initialHtml}),this.props.children)}}),d.react.plugins.router=d.react.router,d.react.router}),function(a){"object"==typeof exports&&"object"==typeof module?module.exports=a(require("react"),require("dotnetify")):"function"==typeof define&&define.amd?define(["react","dotnetify"],a):a(React,dotnetify)}(function(a,b){return b.react.Scope=a.createClass({displayName:"Scope",version:"1.0.1",propTypes:{vm:a.PropTypes.string},contextTypes:{scoped:a.PropTypes.func},childContextTypes:{scoped:a.PropTypes.func.isRequired,connect:a.PropTypes.func.isRequired},scoped:function(a){var b=this.context.scoped?this.context.scoped(this.props.vm):this.props.vm;return b?b+"."+a:a},getChildContext:function(){var a=this;return{scoped:function(b){return a.scoped(b)},connect:function(c,d,e){return d.vmId=a.scoped(c),d.vm=b.react.connect(d.vmId,d,e),d.dispatch=function(a){return d.vm.$dispatch(a)},d.dispatchState=function(a){d.vm.State(a),d.vm.$dispatch(a)},window.vmStates?window.vmStates[d.vmId]:null}}},render:function(){return this.props.children}}),b.react.Scope});